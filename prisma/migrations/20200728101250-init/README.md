# Migration `20200728101250-init`

This migration has been generated by piann <shadow_hat@naver.com> at 7/28/2020, 10:12:50 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE `bb_db`.`HackerInfo` (
`id` varchar(191) NOT NULL ,
`userId` varchar(191) NOT NULL ,
`createdAt` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
`updatedAt` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `bb_db`.`BusinessInfo` (
`id` varchar(191) NOT NULL ,
`userId` varchar(191) NOT NULL ,
`companyName` varchar(191) NOT NULL ,
`createdAt` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
`updatedAt` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

ALTER TABLE `bb_db`.`User` DROP COLUMN `name`,
ADD COLUMN `firstName` varchar(191) NOT NULL ,
ADD COLUMN `lastName` varchar(191) NOT NULL ,
ADD COLUMN `role` ENUM('HACKER', 'BUSINESS', 'ADMIN') NOT NULL ,
MODIFY `reasonOfLock` ENUM('NEW_ACCOUNT', 'TOO_MANY_TRIAL');

CREATE UNIQUE INDEX `HackerInfo_userId` ON `bb_db`.`HackerInfo`(`userId`)

CREATE UNIQUE INDEX `BusinessInfo_userId` ON `bb_db`.`BusinessInfo`(`userId`)

ALTER TABLE `bb_db`.`HackerInfo` ADD FOREIGN KEY (`userId`) REFERENCES `bb_db`.`User`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `bb_db`.`BusinessInfo` ADD FOREIGN KEY (`userId`) REFERENCES `bb_db`.`User`(`id`) ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200727195208-init..20200728101250-init
--- datamodel.dml
+++ datamodel.dml
@@ -2,24 +2,59 @@
 // learn more about it in the docs: https://pris.ly/d/prisma-schema
 datasource db {
   provider = "mysql"
-  url = "***"
+  url = "***"
 }
 generator client {
   provider = "prisma-client-js"
+  binaryTargets = ["native","linux-musl"]
 }
+enum Role{
+  HACKER
+  BUSINESS
+  ADMIN
+}
+
+enum ReasonOfLock{
+  NEW_ACCOUNT
+  TOO_MANY_TRIAL
+}
+
 model User{
     id String @id @default(cuid())
-    name String
+    firstName String
+    lastName String
     email String @unique
     passwordHash String
     phoneNumber String?
     isLocked Boolean @default(true)
-    reasonOfLock String?
+    reasonOfLock ReasonOfLock?
     numberOfLoginFail Int @default(value:0)    
     note String?
+    role Role
+    hackerInfo HackerInfo?
+    businessInfo BusinessInfo?
     createdAt DateTime @default(now())
     updatedAt DateTime @updatedAt @default(now())
+    
+}
+
+model HackerInfo{
+  id String @id @default(cuid())
+  user User @relation(fields: [userId], references: [id])
+  userId String
+  
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt @default(now())
+}
+
+model BusinessInfo{
+  id String @id @default(cuid())
+  user User @relation(fields: [userId], references: [id])
+  userId String
+  companyName String
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt @default(now())
 }
```


