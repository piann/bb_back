# Migration `20200728215435-init`

This migration has been generated by piann <shadow_hat@naver.com> at 7/28/2020, 9:54:35 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "bb_schema"."ReportResult" (
"id" text  NOT NULL ,
"resultCode" "ResultCode" NOT NULL ,
"reportId" text  NOT NULL ,
"note" text   ,
"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
"updatedAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
PRIMARY KEY ("id"))

ALTER TABLE "bb_schema"."Report" DROP COLUMN "resultCode",
ADD COLUMN "bountyAmount" integer  NOT NULL DEFAULT 0;

ALTER TABLE "bb_schema"."ReportResult" ADD FOREIGN KEY ("reportId")REFERENCES "bb_schema"."Report"("id") ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200728213306-init..20200728215435-init
--- datamodel.dml
+++ datamodel.dml
@@ -2,9 +2,9 @@
 // learn more about it in the docs: https://pris.ly/d/prisma-schema
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 generator client {
   provider = "prisma-client-js"
@@ -164,8 +164,19 @@
   createdAt DateTime @default(now())
   updatedAt DateTime @updatedAt @default(now())
 }
+model FileObj{
+  id String @id @default(cuid())
+  isPublic Boolean
+  permittedUserList User[] @relation(references: [id])
+  fileName String
+  mimetype String?
+  rawData String
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt @default(now())
+}
+
 model Report{
   id String @id @default(cuid())
   bugBountyProgram BugBountyProgram @relation(fields: [bbpId], references:[id])
   bbpId String
@@ -190,9 +201,10 @@
   additionalText String?
   reportFile FileObj? @relation(fields: [fileId], references:[id])
   fileId String?
   progressStatus ProgressStatus[]
-  resultCode ResultCode?
+  result ReportResult[]
+  bountyAmount Int @default(value:0)
   evaluationText String?
   commentList ReportComment[]
   createdAt DateTime @default(now())
   updatedAt DateTime @updatedAt @default(now())
@@ -207,22 +219,21 @@
   createdAt DateTime @default(now())
   updatedAt DateTime @updatedAt @default(now())
 }
-model FileObj{
+model ProgressStatus{
   id String @id @default(cuid())
-  isPublic Boolean
-  permittedUserList User[] @relation(references: [id])
-  fileName String
-  mimetype String?
-  rawData String
+  progressIdx Int @default(value:0)
+  report Report @relation(fields: [reportId],references: [id])
+  reportId String
+  note String?
   createdAt DateTime @default(now())
   updatedAt DateTime @updatedAt @default(now())
 }
-model ProgressStatus{
+model ReportResult{
   id String @id @default(cuid())
-  progressIdx Int @default(value:0)
+  resultCode ResultCode
   report Report @relation(fields: [reportId],references: [id])
   reportId String
   note String?
   createdAt DateTime @default(now())
@@ -237,5 +248,5 @@
   fileId String?
   note String?
   createdAt DateTime @default(now())
   updatedAt DateTime @updatedAt @default(now())
-}
+}
```


